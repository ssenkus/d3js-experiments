<!DOCTYPE html>
<html>
  <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
		<title>Vancouver Data - D3.js</title>
        <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?1.25.0"></script>
        <link href='http://fonts.googleapis.com/css?family=Happy+Monkey' rel='stylesheet' type='text/css'>
        <style type="text/css">

            body {
                background: #222;
                color: #fff;
                text-align: center;
                font-family: 'Happy Monkey', cursive;

            }

            h1 {font-size: 30px;}
           circle {
			
		   }
        </style>
  </head>
  <body>
  <svg width="800" height="600" style="background-color: #fff;"></svg>
      <script>
		var color = d3.scale.category20();
		var dataset;
		
		function squares() {
			d3.select('svg')
			.selectAll("rect")
			.data(dataset)
			.enter()
			.append("rect")
			.attr("x", function(d) { return d['Total SF'] / 10;})
			.attr("y", function(d) { return d['Total SF'] / 10;})
			.attr("width", function(d) { return d['Close Price'] / 1000;})
			.attr("height", function(d) { return d['Close Price'] / 1000;})
			.attr("fill",function(d,i){return color(i);})
			.transition()
			.duration(function(d) { return ((Math.random() * 10) * 500) + 200})
			.style('transform','scale(0.5,0.5)');
		}

		function swapSVGLayers(cb) {
			cb();squares();
			var rndEl, timer;
			timer = setInterval(function() {
				var rects = document.getElementsByTagName('rect');
				console.log(rects.length);
				rndEl = (Math.floor(Math.random() * rects.length));
				
				document.getElementsByTagName('svg')[0].removeChild(document.getElementsByTagName('rect')[rndEl]);
			//	cb();
			},100);
		}
	   
			d3.select('body').style('background-color','#39f');
			
			d3.csv('data/Vancouver.csv', function(data, error) {
				(error) ? console.log(error) : console.log(data);
				dataset = data;

								
			/*	
				.selectAll("rect")
   .data(data)
   .enter()
   .append("rect")
   .attr("x", 0)
   .attr("y", 0)
   .attr("width", 20)
   .attr("height", 100);
				*/
				

			squares();
			
			swapSVGLayers(squares);
				/*
				
				.selectAll('rect')
					.data(data)	
					.enter()
					.append('rect')
					.attr("x", function(d){ 
						return d['Total SF'];
					})     //d['Total SF'] / 100;})
					.attr("y", 10)//function(d){ return d['Total SF'] / 100;})

					.style("height", 10)
					.style("width", 10);
					//.style("stroke-opacity", 1e-6)
//					.style("stroke", '#000')
	//				.style('fill','#f00')
		//			.style("width", 3)
				.transition()
	//				.duration(750)
	//				.attr("r", 2)
			//		.style("stroke-opacity", 1);
					
					/*
					style('width', function(d) {
						console.log(d['Total SF'] / 10);
						return (d['Total SF'] / 10);
					})
					.style('r','40');
					*/
					//.text(function(d, i) { console.log(d); return d.Public; });
					
					/*
				d3.select('svg')
					.selectAll('circle')
					.data(data)
					.enter()
					.append('circle')
					.attr("cx", function(d){ return d['Total SF'] / 10;})
					.attr("cy", function(d){ return d['Total SF'] / 10;})
					.attr("r", function(d){ return d['Total SF'] / 10;})
					.style("fill", "none")
					.style("stroke", "red")
					.style("stroke-opacity", 1e-6)
					.style("stroke-width", 3)
					.transition()
					.duration(2750)
					.attr("r", 2)
					.style("stroke-opacity", 1);
					*/
			});


      </script>
      
  </body>
</html>
